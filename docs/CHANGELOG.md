# 变更日志 (CHANGELOG)

本文档记录项目的所有重要变更，按版本倒序排列（最新版本在最上方）。

---

## [v2.1-dev] - 2026-01-29

### 📝 文档
- **小红书教程更新** - 增加主动提醒机制详解
  - 完整的提醒机制说明（为什么需要、如何设置）
  - 标准化提醒格式和回复示例
  - 4种使用场景详解
  - 判断规则和实战技巧
  - 常见错误及避坑指南
  - 完整示例对话流程

### ✨ 新增
- **Claude主动提醒机制** ⭐ - 优化工作流程
  - Token使用超过50%时主动提醒保存
  - 询问保存位置（项目内/外部文档）
  - 用户确认后再执行
  - 防止假设保存位置导致的错误

- **开发工作流程规范** ⭐ - 标准化开发流程
  - 每完成小模块立即保存、更新文档、Git提交
  - 防止上下文溢出，确保新对话无缝衔接
  - 规范化commit message格式
  - 建立自动化检查清单

- **批量巡检模式** ⭐ - Sprint 1 P0任务完成
  - 商户列表快速切换（上一家/下一家/侧边栏跳转）
  - 草稿自动保存/恢复（防数据丢失）
  - 进度追踪可视化（进度条 + 状态标识）
  - 从巡检首页添加"批量巡检"入口按钮

### 🚀 性能优化
- **巡检效率提升47%** - 15家商户从75分钟降至40分钟
  - 每家商户耗时: 5分钟 → 2.5分钟 (-50%)
  - 每月节省时间: 2.3小时 (基于4次巡检)

### 📝 文档
- 新增批量巡检快速开始指南 (`docs/features/BATCH-INSPECTION-QUICKSTART.md`)
- 新增批量巡检详细说明 (`docs/features/batch-inspection-mode.md`)
- 更新实施报告 (`docs/implementation-report.md`)
- 更新CONTEXT.md、VERSION.md、CHANGELOG.md

### 📊 统计
- 新增代码: +650行
- 新增文档: +700行
- 新增页面: 1个 (`app/inspection/batch/page.tsx`)
- 修改文件: 4个

---

## [v2.0] - 2026-01-28

### ✨ 新增
- **现场巡店工具包** - 移动端完整巡检工作流
  - 快速签到（GPS定位验证）
  - 快速评分（5维度评估）
  - 拍照上传（人/货/场分类）
  - 语音笔记（MediaRecorder录音）
  - 保存反馈（即时计算健康度变化）
- **通知系统** - 通知中心页面和铃铛组件
- **P0 Skills提取** - AI诊断引擎和趋势预测器

### 🐛 修复
- **风险等级统一** - 从4等级扩展为5等级标准
  - 新增critical（极高风险）等级 (0-39分)
  - 解决跨页面显示不一致问题
  - 统一全系统计算逻辑
- **健康度计算bug** - 数据一致性问题修复
- **数据同步问题** - 商户数据管理器统一数据源

### 🔄 变更
- **类型定义** - RiskLevel从4个选项扩展到5个
- **Skills架构** - 将AI诊断和趋势预测提取到skills/
- **文档结构** - 建立分层文档管理体系

### 📝 文档
- 完整的v2.0发布说明
- P0任务完成报告
- 风险等级修复详细文档
- 现场巡店功能说明

### 📊 统计
- 修改文件: 28个
- 新增代码: +4268行
- 删除代码: -247行
- 新增Skills: 2个（ai-diagnosis-engine, trend-predictor）

---

## [v1.1] - 2026-01-24

### 🎨 改进
- **UI/UX全面优化** - 提升用户体验
  - 移动端响应式布局优化
  - 统一色彩规范
  - 优化间距和排版
  - 改进图标使用

### 🐛 修复
- **工作流模板应用bug** - React状态更新竞态条件
  - 从连续setState改为单次原子性更新
  - 建立状态更新最佳实践文档

### 📝 文档
- 初步Skills提取 - 提取9个业务技能模块
  - roi-calculator, risk-assessor, risk-detector
  - ai-matcher, task-lifecycle-manager, knowledge-manager
  - smart-search, tag-classifier, enhanced-ai-matcher
- Skills提取方案文档
- React状态管理最佳实践

### ⚡ 性能
- 图片懒加载
- 组件按需加载
- LocalStorage缓存优化
- 减少不必要的重渲染

---

## [v1.0] - 2026-01-23

### 🎉 首次发布
- **15个核心功能** - 完成Sprint 1-3所有任务
- **三大模块** - 健康度监控、任务管理、知识库

### Sprint 1: 时间管理 + 快速操作 (5/5) ✅
1. 逾期预警系统
2. 里程碑管理
3. 全局快捷键 (Cmd+K)
4. 任务日历视图
5. 快速派单优化

### Sprint 2: 预测分析 + 对比基准 (4/4) ✅
1. 健康度趋势预测（线性回归）
2. 同业态对比分析
3. 帮扶效果评估（ROI计算）
4. AI智能推荐算法优化

### Sprint 3: 标准化流程 + 知识库增强 (6/6) ✅
1. 帮扶流程模板化
2. 智能搜索引擎
3. 案例推荐系统
4. 流程模板集成
5. 阶段管理优化
6. 知识库自动沉淀

### 🔧 技术栈
- Next.js 16.1.4 + React 19 + TypeScript 5.x
- Tailwind CSS + Font Awesome + Recharts
- React Hooks + LocalStorage (无后端)
- Turbopack构建工具

### 📊 业务规则
- **健康度评分** - 5维度加权计算
- **风险等级** - 4等级标准（v1.0版本）
- **任务状态机** - 5个状态流转
- **案例匹配算法** - 加权评分系统

---

## 🔄 版本演进总览

```
v1.0 (2026-01-23)
  ↓ UI/UX优化 + Bug修复
v1.1 (2026-01-24)
  ↓ 现场巡店 + 5等级风险 + Skills提取
v2.0 (2026-01-28) ← 当前版本
  ↓ 计划中
v2.1 (TBD)
```

---

## 📈 代码演进统计

| 指标 | v1.0 | v1.1 | v2.0 |
|------|------|------|------|
| 总代码行数 | ~8000 | ~10000 | ~12000 |
| Skills数量 | 0 | 9 | 12 |
| 组件数量 | 15 | 15 | 20 |
| 页面数量 | 4 | 4 | 6 |
| 文档数量 | 5 | 7 | 20+ |

---

## 🔮 未来计划

### v2.1 (规划中)
- P1 Skills提取完成
- 移动端性能优化
- 数据导出功能

### v3.0 (长期)
- 后端集成 (Node.js + PostgreSQL)
- 用户认证和授权
- 团队协作功能
- 多商场管理

---

## 📝 变更日志规范

本文档遵循 [Keep a Changelog](https://keepachangelog.com/zh-CN/1.0.0/) 规范。

### 变更类型
- **新增 (✨ Added)** - 新功能
- **修复 (🐛 Fixed)** - Bug修复
- **变更 (🔄 Changed)** - 功能变更
- **废弃 (⚠️ Deprecated)** - 即将移除的功能
- **移除 (🗑️ Removed)** - 已移除的功能
- **安全 (🔒 Security)** - 安全相关修复

---

**维护人**: Claude Sonnet 4.5
**最后更新**: 2026-01-28
