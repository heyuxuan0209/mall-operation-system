# 文档优化SOP - 快速参考卡片

**版本**: v1.0
**用途**: 1-2页快速Checklist，可打印或收藏

---

## 📋 第1部分：诊断Checklist（10项快速检查）

**目标**：5分钟识别项目文档的主要问题

### 冗余重复（3项）

- [ ] **DR-1**: 根目录是否有>5个markdown文档？
  - ✅ 正常：≤5个（CONTEXT.md, README.md, PROJECT_HANDOVER.md, VERSION.md, LICENSE.md）
  - ❌ 异常：>5个，说明可能有冗余

- [ ] **DR-2**: 同一信息是否在多个文档中重复？
  - 🔍 检查方法：搜索关键术语（如项目名称、版本号），统计出现次数
  - ❌ 异常：关键信息在>3个文档中出现

- [ ] **DR-3**: 是否存在多个相似命名的文档？
  - ❌ 示例：`REPORT.md` + `REPORT-v2.md` + `REPORT-FINAL.md`
  - ✅ 正常：只保留最新版本，历史版本归档

### 组织混乱（3项）

- [ ] **DM-1**: 是否有测试脚本混杂在docs/目录？
  - ❌ 异常：`docs/test-*.js`, `docs/*-validator.html`
  - ✅ 正常：测试脚本在`scripts/testing/`

- [ ] **DM-2**: 是否有过时文档未归档？
  - ❌ 异常：根目录有`SPRINT1_REPORT.md`, `OLD_README.md`
  - ✅ 正常：历史文档在`docs/archive/`

- [ ] **DM-3**: 是否有空目录占位？
  - ❌ 异常：`mkdir` 了目录但从未使用
  - ✅ 正常：要么有内容，要么不创建

### 信息不突出（2项）

- [ ] **DI-1**: 新AI会话恢复上下文需要读取几个文档？
  - ✅ 优秀：1个（CONTEXT.md）
  - ⚠️ 可接受：2-3个（CONTEXT + SNAPSHOT + README）
  - ❌ 异常：>3个文档

- [ ] **DI-2**: 快速恢复文档的Token消耗是否过高？
  - ✅ 优秀：<200 tokens
  - ⚠️ 可接受：200-500 tokens
  - ❌ 异常：>500 tokens

### 版本管理（2项）

- [ ] **DV-1**: 是否能快速定位当前版本状态？
  - ✅ 正常：有CONTEXT.md或VERSION.md记录
  - ❌ 异常：需要查看多个文档或git log才能确定

- [ ] **DV-2**: 历史版本文档是否清晰标注？
  - ✅ 正常：文件名包含版本号（v1.0-SNAPSHOT.md）
  - ❌ 异常：多个文档混杂，不清楚哪个是最新

---

## 🔧 第2部分：优化Checklist（5步操作流程）

**目标**：20分钟完成核心优化

### 步骤1: 创建核心索引文档（5分钟）

- [ ] **OP-1.1**: 创建`CONTEXT.md`（根目录）
  - 📝 使用模板：`templates/CONTEXT.md.template`
  - 🎯 目标：<200 tokens，包含最近活动、待办事项、快速链接
  - ✅ 完成标准：新会话只需读这一个文档即可恢复80%上下文

- [ ] **OP-1.2**: 创建`PROJECT_HANDOVER.md`（根目录）
  - 📝 使用模板：`templates/PROJECT_HANDOVER.md.template`
  - 🎯 目标：精简版交接文档，200-300行
  - ✅ 完成标准：包含技术栈、核心业务规则、目录结构

- [ ] **OP-1.3**: 创建`docs/INDEX.md`（文档总索引）
  - 📝 使用模板：`templates/INDEX.md.template`
  - 🎯 目标：分类索引所有文档，提供按场景查找
  - ✅ 完成标准：任何文档都能在索引中快速定位

### 步骤2: 建立三层金字塔结构（5分钟）

- [ ] **OP-2.1**: 创建`docs/snapshots/`目录
  - 📝 用途：存放版本快照（vX.X-SNAPSHOT.md）
  - ✅ 完成标准：每个主版本有一个快照文件

- [ ] **OP-2.2**: 创建`docs/`分类子目录
  - 📝 推荐结构：
    ```
    docs/
    ├── snapshots/         # 版本快照
    ├── architecture/      # 架构文档
    ├── releases/          # 发布文档
    ├── standards/         # 标准规范
    ├── guides/            # 操作指南
    ├── planning/          # 规划待办
    ├── issues/            # 问题和修复
    └── archive/           # 归档文档
    ```
  - ✅ 完成标准：每个分类有清晰用途

### 步骤3: 归档历史文档（3分钟）

- [ ] **OP-3.1**: 创建`docs/archive/README.md`
  - 📝 使用模板：`templates/archive-README.md.template`
  - 🎯 目标：说明归档规则和目录结构

- [ ] **OP-3.2**: 移动历史文档到archive/
  - 📝 归档触发条件：
    - ✅ 已被新文档替代
    - ✅ 属于历史版本
    - ✅ 内容已过时
  - ⚠️ 不要删除：归档≠删除，保留历史参考

- [ ] **OP-3.3**: 在archive/内按版本或类型分类
  - 📝 推荐结构：
    ```
    archive/
    ├── v1.0/              # v1.0版本归档
    ├── bug-fixes-history/ # Bug修复历史
    └── temporary/         # 临时文档归档
    ```

### 步骤4: 规范化脚本和测试文件（3分钟）

- [ ] **OP-4.1**: 创建`scripts/`目录（根目录）
  - 📝 用途：存放所有自动化脚本和测试文件
  - ✅ 完成标准：docs/目录不再包含.js/.html/.sh文件

- [ ] **OP-4.2**: 移动测试脚本到scripts/testing/
  - 📝 示例：
    ```bash
    mkdir -p scripts/testing
    mv test-*.js scripts/testing/
    mv *-validator.html scripts/testing/
    ```

- [ ] **OP-4.3**: 移动工具脚本到scripts/tools/
  - 📝 示例：部署脚本、构建脚本、数据生成脚本

### 步骤5: 验证和完善（4分钟）

- [ ] **OP-5.1**: 检查根目录文档数量
  - ✅ 目标：≤5个markdown文档
  - 🔍 命令：`ls -1 *.md | wc -l`

- [ ] **OP-5.2**: 验证CONTEXT.md的Token消耗
  - ✅ 目标：<200 tokens
  - 🔍 工具：使用tiktoken或AI估算

- [ ] **OP-5.3**: 检查链接有效性
  - ✅ 目标：所有内部链接可访问
  - 🔍 工具：`scripts/validate-consistency.sh`（如果已创建）

- [ ] **OP-5.4**: 更新README.md
  - 📝 确保指向CONTEXT.md和docs/INDEX.md
  - ✅ 完成标准：新用户能找到文档入口

---

## ✅ 第3部分：验证Checklist（3类验证指标）

**目标**：10分钟验证优化效果

### 功能验证（3项）

- [ ] **VF-1**: 快速恢复测试
  - 🎯 目标：新AI会话只需读取CONTEXT.md即可开始工作
  - ✅ 通过标准：CONTEXT.md包含：
    - 当前版本状态
    - 最近7天活动
    - Top 3待办事项
    - 快速链接到详细文档

- [ ] **VF-2**: 文档查找测试
  - 🎯 目标：任何文档都能在30秒内定位
  - ✅ 通过标准：docs/INDEX.md提供：
    - 分类索引
    - 按场景查找
    - 关键词搜索提示

- [ ] **VF-3**: 一致性测试
  - 🎯 目标：关键术语拼写一致，版本号同步
  - ✅ 通过标准：
    - 项目名称拼写一致
    - 版本号在CONTEXT.md、VERSION.md、CHANGELOG.md中同步
    - 链接有效（无404）

### 结构验证（3项）

- [ ] **VS-1**: 根目录清洁度
  - ✅ 通过标准：
    - Markdown文档 ≤ 5个
    - 无测试脚本（.js/.html/.sh）
    - 无历史文档（SPRINT*.md, OLD*.md）

- [ ] **VS-2**: docs/目录规范性
  - ✅ 通过标准：
    - 有明确的分类子目录
    - 每个子目录有清晰用途
    - archive/内有README.md说明

- [ ] **VS-3**: scripts/目录规范性
  - ✅ 通过标准：
    - 所有测试脚本在scripts/testing/
    - 所有工具脚本在scripts/tools/
    - 无空目录

### 效果验证（3项）

- [ ] **VE-1**: Token消耗降低
  - 🎯 目标：快速恢复Token消耗降低>80%
  - 📊 测量：
    - 优化前：读取X个文档，~Y tokens
    - 优化后：读取CONTEXT.md，<200 tokens
    - 降幅：(Y-200)/Y × 100%

- [ ] **VE-2**: 查找时间缩短
  - 🎯 目标：查找任何文档时间<30秒
  - 📊 测量：
    - 优化前：需要浏览多个目录，1-3分钟
    - 优化后：查看INDEX.md，<30秒

- [ ] **VE-3**: 维护成本降低
  - 🎯 目标：更新文档时不再需要手工同步多处
  - ✅ 通过标准：
    - 每个信息点只在一处维护
    - 其他地方通过链接引用
    - 单一数据源原则得到遵守

---

## 📊 第4部分：模板文件清单（快速定位）

**目标**：快速找到所需模板

| 模板文件 | 路径 | 用途 | 预估填充时间 |
|---------|------|------|-------------|
| **CONTEXT.md** | `templates/CONTEXT.md.template` | 快速上下文索引 | 10分钟 |
| **PROJECT_HANDOVER.md** | `templates/PROJECT_HANDOVER.md.template` | 项目交接文档 | 20分钟 |
| **VERSION.md** | `templates/VERSION.md.template` | 版本历史记录 | 5分钟 |
| **archive-README.md** | `templates/archive-README.md.template` | 归档目录说明 | 3分钟 |
| **INDEX.md** | `templates/INDEX.md.template` | 文档总索引 | 15分钟 |

**使用方式**：
```bash
# 复制模板到目标位置
cp templates/CONTEXT.md.template ../../CONTEXT.md

# 填充项目实际信息
vim ../../CONTEXT.md
```

---

## 🔧 第5部分：脚本工具清单（快速使用）

**目标**：使用自动化工具提升效率

| 脚本 | 路径 | 用途 | 执行时间 |
|------|------|------|---------|
| **结构分析** | `scripts/analyze-structure.sh` | 诊断文档问题 | 10秒 |
| **一致性验证** | `scripts/validate-consistency.sh` | 验证优化效果 | 15秒 |
| **归档生成** | `scripts/generate-archive.sh` | 快速创建归档 | 5秒 |

**使用示例**：
```bash
# 1. 诊断当前项目
bash scripts/analyze-structure.sh

# 输出示例：
# ✅ 根目录文档数量: 3个 (正常)
# ❌ 发现重复内容: project-name在5个文档中出现
# ⚠️  发现测试脚本: docs/test-data.js
# ✅ 归档目录已创建

# 2. 执行优化后验证
bash scripts/validate-consistency.sh

# 输出示例：
# ✅ CONTEXT.md Token消耗: 178 tokens
# ✅ 所有链接有效: 23/23
# ✅ 版本号一致: v2.0
# ❌ 发现拼写不一致: "Mall Operation" vs "Mall-Operation"

# 3. 快速创建归档
bash scripts/generate-archive.sh v1.0

# 输出示例：
# ✅ 创建目录: docs/archive/v1.0/
# ✅ 生成README: docs/archive/v1.0/README.md
# ✅ 移动文档: SPRINT1_REPORT.md → docs/archive/v1.0/
```

---

## 💡 第6部分：常见陷阱（避免踩坑）

### 陷阱1: 过度归档

❌ **错误做法**：把所有"看起来旧"的文档都归档
✅ **正确做法**：只归档**已被替代**或**确认过时**的文档

**判断方法**：
- 是否有新文档替代？（有 → 归档）
- 是否仍在使用？（是 → 保留）
- 是否包含唯一信息？（是 → 保留或迁移后归档）

### 陷阱2: 过度精简

❌ **错误做法**：删除所有"不常用"的文档
✅ **正确做法**：保留所有有价值的信息，只是重新组织

**原则**：
- 归档≠删除
- 精简≠丢弃信息
- 优化结构，不丢内容

### 陷阱3: CONTEXT.md过于详细

❌ **错误做法**：把所有项目信息都塞进CONTEXT.md
✅ **正确做法**：只保留"快速恢复"所需的最小信息

**Token控制**：
- 目标：<200 tokens
- 策略：高度概括 + 链接到详细文档
- 原则：能链接就不重复

### 陷阱4: 忽略持续维护

❌ **错误做法**：优化一次后就不再更新
✅ **正确做法**：建立维护习惯

**三个习惯**：
1. **日常更新** - 每次开发后更新CONTEXT.md
2. **版本发布** - 创建快照、更新VERSION.md
3. **触发归档** - 文档被替代时立即归档

### 陷阱5: 模板照搬不改

❌ **错误做法**：直接使用模板，不根据项目调整
✅ **正确做法**：模板是起点，需要根据项目特点定制

**定制要点**：
- 调整章节顺序（突出项目重点）
- 修改分类名称（符合项目术语）
- 增删内容（适应项目规模）

---

## 🎯 第7部分：一分钟速查表

### 诊断（5秒快速判断）

```
根目录文档>5个？         → ❌ 需要优化
找不到快速恢复文档？     → ❌ 需要优化
历史文档未归档？         → ❌ 需要优化
测试脚本在docs/?        → ❌ 需要优化
```

### 优化（20分钟核心动作）

```
1. 创建CONTEXT.md        (5分钟)
2. 创建docs/结构         (5分钟)
3. 归档历史文档           (3分钟)
4. 规范化脚本             (3分钟)
5. 验证效果               (4分钟)
```

### 验证（3个关键指标）

```
✅ 根目录文档 ≤ 5个
✅ CONTEXT.md < 200 tokens
✅ 30秒内能定位任何文档
```

---

## 📝 使用记录（填写后作为项目档案）

**项目名称**: ___________________________

**优化日期**: ___________________________

**执行人**: ___________________________

### 诊断结果

- [ ] DR-1: 根目录文档数量: ____个（目标: ≤5）
- [ ] DR-2: 重复内容: ____处（目标: 0）
- [ ] DM-1: 混杂脚本: ____个（目标: 0）
- [ ] DI-1: 快速恢复文档数: ____个（目标: 1）

### 优化执行

- [ ] OP-1: 创建核心索引文档 ✅
- [ ] OP-2: 建立三层金字塔结构 ✅
- [ ] OP-3: 归档历史文档 ✅
- [ ] OP-4: 规范化脚本文件 ✅
- [ ] OP-5: 验证和完善 ✅

### 优化效果

- **Token消耗**：优化前 ____tokens → 优化后 ____tokens（降幅: ____%）
- **查找时间**：优化前 ____秒 → 优化后 ____秒（缩短: ____%）
- **根目录文档**：优化前 ____个 → 优化后 ____个

### 经验教训

**遇到的问题**：
1. ___________________________
2. ___________________________

**解决方案**：
1. ___________________________
2. ___________________________

**改进建议**：
1. ___________________________
2. ___________________________

---

**维护人**: Claude Sonnet 4.5
**最后更新**: 2026-01-28
**版本**: v1.0
