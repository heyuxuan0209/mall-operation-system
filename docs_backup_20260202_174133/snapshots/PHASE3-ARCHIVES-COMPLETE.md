# Phase 3: ç‹¬ç«‹æ¡£æ¡ˆé¡µé¢ + ç»Ÿè®¡æ•°å­—äº¤äº’ - å®Œæˆæ€»ç»“

**å®Œæˆæ—¶é—´**: 2026-02-01
**åŠŸèƒ½çŠ¶æ€**: âœ… å·²å®Œæˆå¹¶é€šè¿‡ç¼–è¯‘éªŒè¯

---

## åŠŸèƒ½æ¦‚è¿°

Phase 3 è§£å†³äº†ä¸¤ä¸ªæ ¸å¿ƒç”¨æˆ·éœ€æ±‚ï¼š

1. **ç»Ÿè®¡æ•°å­—å¯ç‚¹å‡»æŸ¥çœ‹æ˜ç»†**: æ¡£æ¡ˆæ‘˜è¦ä¸­çš„6ä¸ªç»Ÿè®¡å¡ç‰‡ç°åœ¨å¯ç‚¹å‡»ï¼Œå¼¹å‡ºè¯¦ç»†åˆ—è¡¨
2. **ç‹¬ç«‹æ¡£æ¡ˆé¡µé¢**: åˆ›å»ºå…¨å±æ¡£æ¡ˆé¡µé¢ï¼Œè§£å†³ç©ºé—´ä¸è¶³å’Œå›¾è¡¨å‹ç¼©é—®é¢˜ï¼Œå¹¶æä¾›å¤šä¸ªå¿«æ·å…¥å£

---

## å®æ–½å†…å®¹

### ä¸€ã€æ–°å¢æ–‡ä»¶ (6ä¸ª)

#### 1. `components/ui/Modal.tsx` (~120è¡Œ)
**åŠŸèƒ½**: é€šç”¨æ¨¡æ€æ¡†ç»„ä»¶

**ç‰¹æ€§**:
- ESCé”®å…³é—­
- ç‚¹å‡»é®ç½©å±‚å…³é—­
- é˜²æ­¢èƒŒæ™¯æ»šåŠ¨
- å¯é…ç½®æœ€å¤§å®½åº¦ (sm/md/lg/xl/2xl/4xl)

```tsx
<Modal isOpen={true} onClose={handleClose} maxWidth="4xl">
  {/* å†…å®¹ */}
</Modal>
```

---

#### 2. `app/archives/layout.tsx` (~50è¡Œ)
**åŠŸèƒ½**: æ¡£æ¡ˆé¡µé¢é€šç”¨å¸ƒå±€

**ç‰¹æ€§**:
- å›ºå®šå¤´éƒ¨å¯¼èˆª
- é¢åŒ…å±‘å¯¼èˆªï¼ˆè¯¦æƒ…é¡µæ˜¾ç¤º"è¿”å›æ¡£æ¡ˆåº“"ï¼‰
- ç»Ÿä¸€çš„é¡µé¢æ ‡é¢˜å’Œå›¾æ ‡

---

#### 3. `app/archives/page.tsx` (~300è¡Œ)
**åŠŸèƒ½**: æ¡£æ¡ˆåº“ä¸»é¡µ - å•†æˆ·åˆ—è¡¨è§†å›¾

**ç‰¹æ€§**:
- **æœç´¢**: æŒ‰å•†æˆ·åç§°æœç´¢
- **ç­›é€‰**: æŒ‰é£é™©ç­‰çº§è¿‡æ»¤ (å…¨éƒ¨/æé«˜/é«˜/ä¸­/ä½/æ— )
- **æ’åº**: æœ€è¿‘æ›´æ–°/å¥åº·åº¦/æˆåŠŸç‡/é£é™©ç­‰çº§
- **åŒè§†å›¾**: è¡¨æ ¼è§†å›¾ï¼ˆé»˜è®¤ï¼‰å’Œå¡ç‰‡è§†å›¾
- **ç»Ÿè®¡æ¦‚è§ˆ**: æ˜¾ç¤ºæ€»æ¡£æ¡ˆæ•°ã€é«˜é£é™©å•†æˆ·æ•°ã€å¹³å‡æˆåŠŸç‡ã€ç­›é€‰ç»“æœæ•°

**è·¯ç”±**: `/archives`

**å…³é”®å®ç°**:
```tsx
// ä½¿ç”¨ useMemo ä¼˜åŒ–è¿‡æ»¤å’Œæ’åºæ€§èƒ½
const filteredMerchants = useMemo(() => {
  let result = mockMerchants.filter(/* æœç´¢å’Œé£é™©ç­›é€‰ */);
  result.sort(/* æŒ‰é€‰å®šæ¡ä»¶æ’åº */);
  return result;
}, [searchTerm, riskFilter, sortBy]);
```

---

#### 4. `app/archives/[merchantId]/page.tsx` (~200è¡Œ)
**åŠŸèƒ½**: å•†æˆ·æ¡£æ¡ˆè¯¦æƒ…é¡µ - å…¨å±å±•ç¤º

**ç‰¹æ€§**:
- **å•†æˆ·ä¿¡æ¯å¤´éƒ¨**: æ¸å˜èƒŒæ™¯ + å½“å‰é£é™©ç­‰çº§å¾½ç« 
- **åŸºæœ¬ä¿¡æ¯ç½‘æ ¼**: 8ä¸ªå­—æ®µï¼ˆæ¥¼å±‚/é¢ç§¯/ç§Ÿé‡‘/è¥æ”¶/ç§Ÿå”®æ¯”/å¥åº·åº¦/çŠ¶æ€/æ›´æ–°æ—¶é—´ï¼‰
- **å¿«æ·æ“ä½œ**: è·³è½¬åˆ°å¥åº·åº¦ç›‘æ§/ä»»åŠ¡ä¸­å¿ƒ/å·¡åº—è®°å½•
- **å®Œæ•´æ¡£æ¡ˆ**: å¤ç”¨ `MerchantHistoryArchive` ç»„ä»¶ï¼Œå…¨å±å±•ç¤º

**è·¯ç”±**: `/archives/[merchantId]`
**ç¤ºä¾‹**: `/archives/M001`

**æ•°æ®éªŒè¯**: æœªæ‰¾åˆ°å•†æˆ·æ—¶æ˜¾ç¤º404é¡µé¢

---

#### 5. `utils/archiveDataHelper.ts` (~150è¡Œ)
**åŠŸèƒ½**: æ¡£æ¡ˆæ•°æ®å¤„ç†å·¥å…·ç±»

**æ ¸å¿ƒæ–¹æ³•**:

| æ–¹æ³• | åŠŸèƒ½ |
|------|------|
| `groupSnapshotsByTrigger()` | æŒ‰è§¦å‘ç±»å‹åˆ†ç»„å¿«ç…§ |
| `categorizeRiskChanges()` | åˆ†ç±»é£é™©å˜æ›´ï¼ˆæ”¹å–„/æ¶åŒ–/ç¨³å®šï¼‰ |
| `formatRelativeTime()` | æ ¼å¼åŒ–ç›¸å¯¹æ—¶é—´ (ä»Šå¤©/æ˜¨å¤©/3å¤©å‰) |
| `getRiskLevelLabel()` | è·å–é£é™©ç­‰çº§ä¸­æ–‡æ ‡ç­¾ |
| `getRiskLevelIcon()` | è·å–é£é™©ç­‰çº§Font Awesomeå›¾æ ‡ |
| `getRiskLevelColor()` | è·å–é£é™©ç­‰çº§Tailwindé¢œè‰²ç±» |
| `getChangeTypeStyle()` | è·å–å˜æ›´ç±»å‹æ ·å¼ (æ”¹å–„/æ¶åŒ–/ç¨³å®š) |
| `getTaskStatusStyle()` | è·å–ä»»åŠ¡çŠ¶æ€æ ·å¼ |
| `getPriorityStyle()` | è·å–ä¼˜å…ˆçº§æ ·å¼ |

**ç¤ºä¾‹**:
```tsx
ArchiveDataHelper.formatRelativeTime('2026-01-25'); // "7å¤©å‰"
ArchiveDataHelper.getRiskLevelColor('high'); // { bg: 'bg-red-100', text: 'text-red-700' }
```

---

#### 6. `components/merchants/StatDetailModal.tsx` (~460è¡Œ)
**åŠŸèƒ½**: ç»Ÿè®¡æ˜ç»†å¼¹çª—ç»„ä»¶

**5ç§è§†å›¾ç±»å‹**:

##### 1. å†å²è®°å½•æ˜ç»† (snapshots)
- å®Œæ•´å¿«ç…§åˆ—è¡¨ï¼ŒæŒ‰æ—¶é—´å€’åº
- æ˜¾ç¤ºï¼šæ—¶é—´ã€å¥åº·åº¦ã€é£é™©ç­‰çº§ã€è¥æ”¶ã€ç§Ÿå”®æ¯”ã€è§¦å‘äº‹ä»¶
- æ”¯æŒç›¸å¯¹æ—¶é—´æ˜¾ç¤º

##### 2. é£é™©å˜æ›´æ˜ç»† (riskChanges)
- é£é™©ç­‰çº§å˜æ›´å†å²
- æ”¹å–„ï¼ˆç»¿è‰²è¾¹æ¡†ï¼‰å’Œæ¶åŒ–ï¼ˆçº¢è‰²è¾¹æ¡†ï¼‰åŒºåˆ†
- æ˜¾ç¤ºï¼šbeforeâ†’afterå¯¹æ¯”ã€è¯„åˆ†å˜åŒ–ã€è§¦å‘åŸå› 

##### 3. å¸®æ‰¶ä»»åŠ¡æ˜ç»† (tasks)
- å•†æˆ·æ‰€æœ‰å¸®æ‰¶ä»»åŠ¡åˆ—è¡¨
- æ˜¾ç¤ºï¼šçŠ¶æ€ã€ä¼˜å…ˆçº§ã€æªæ–½æ•°é‡ã€æ”¹å–„å€¼ã€è´Ÿè´£äºº
- ä»»åŠ¡æœŸé—´ï¼ˆå¼€å§‹-æˆªæ­¢æ—¥æœŸï¼‰

##### 4. é£é™©æ”¹å–„æ˜ç»† (improvements)
- ç­›é€‰æ‰€æœ‰é£é™©å‡çº§äº‹ä»¶
- ç»¿è‰²ä¸»é¢˜
- æ˜¾ç¤ºï¼šè¯„åˆ†æå‡ã€å…³è”ä»»åŠ¡ã€æ—¶é—´

##### 5. é£é™©æ¶åŒ–æ˜ç»† (deteriorations)
- ç­›é€‰æ‰€æœ‰é£é™©é™çº§äº‹ä»¶
- çº¢è‰²ä¸»é¢˜
- æ˜¾ç¤ºï¼šè¯„åˆ†ä¸‹é™ã€åŸå› åˆ†æã€æ—¶é—´

**ä½¿ç”¨ç¤ºä¾‹**:
```tsx
<StatDetailModal
  type="snapshots"
  data={{ snapshots, riskChanges, tasks }}
  onClose={() => setModalState({ type: null })}
/>
```

---

### äºŒã€ä¿®æ”¹æ–‡ä»¶ (4ä¸ª)

#### 1. `components/merchants/AssistanceArchiveSummary.tsx` (+~80è¡Œ)

**æ–°å¢åŠŸèƒ½**: ç»Ÿè®¡å¡ç‰‡å¯ç‚¹å‡» + å¼¹çª—é›†æˆ

**å…³é”®æ”¹åŠ¨**:
```tsx
// âœ… æ–°å¢props
interface AssistanceArchiveSummaryProps {
  archive: AssistanceArchive;
  merchantId: string;  // â­ æ–°å¢
  onExport?: () => void;
}

// âœ… æ–°å¢å¯¼å…¥
import StatDetailModal from './StatDetailModal';
import { historyArchiveService } from '@/utils/historyArchiveService';

// âœ… æ–°å¢çŠ¶æ€
const [modalState, setModalState] = useState<{
  type: 'snapshots' | 'riskChanges' | 'tasks' | 'improvements' | 'deteriorations' | null;
}>({ type: null });

// âœ… è·å–åŸå§‹æ•°æ®
const snapshots = useMemo(() => historyArchiveService.getSnapshots(merchantId), [merchantId]);
const riskChanges = useMemo(() => historyArchiveService.getRiskChanges(merchantId), [merchantId]);
const tasks = useMemo(() => mockTasks.filter(t => t.merchantId === merchantId), [merchantId]);
```

**å¡ç‰‡æ”¹åŠ¨** (6ä¸ªç»Ÿè®¡å¡ç‰‡):
```tsx
// âŒ æ—§ä»£ç  (div)
<div className="bg-slate-50 rounded-lg p-4">
  <div className="text-xs text-slate-500">å†å²è®°å½•</div>
  <div className="text-2xl font-bold">{archive.stats.totalSnapshots}</div>
</div>

// âœ… æ–°ä»£ç  (button)
<button
  onClick={() => setModalState({ type: 'snapshots' })}
  className="bg-slate-50 rounded-lg p-4 hover:bg-slate-100 hover:shadow-md transition-all cursor-pointer text-left w-full"
>
  <div className="flex items-center justify-between mb-2">
    <div className="flex items-center gap-2">
      <i className="fa-solid fa-camera text-slate-400"></i>
      <span className="text-xs text-slate-500">å†å²è®°å½•</span>
    </div>
    <i className="fas fa-chevron-right text-slate-400 text-xs"></i> {/* â­ æ–°å¢å³ç®­å¤´ */}
  </div>
  <div className="text-2xl font-bold text-slate-900">{archive.stats.totalSnapshots}</div>
  <div className="text-xs text-slate-500 mt-1">ä¸ªå¿«ç…§ Â· ç‚¹å‡»æŸ¥çœ‹æ˜ç»†</div> {/* â­ æ–°å¢æç¤º */}
</button>
```

**å¼¹çª—æ¸²æŸ“**:
```tsx
{modalState.type && (
  <StatDetailModal
    type={modalState.type}
    data={{ snapshots, riskChanges, tasks }}
    onClose={() => setModalState({ type: null })}
  />
)}
```

---

#### 2. `components/layout/Sidebar.tsx` (+~10è¡Œ)

**æ–°å¢åŠŸèƒ½**: æ·»åŠ "æ¡£æ¡ˆåº“"å¯¼èˆªèœå•

**æ”¹åŠ¨1: menuItemsæ•°ç»„**
```tsx
const menuItems = [
  { id: 'dashboard', label: 'æ€»è§ˆ', fullLabel: 'è¿è¥æ€»è§ˆ', icon: 'fa-chart-pie', path: '/' },
  { id: 'health', label: 'ç›‘æ§', fullLabel: 'å¥åº·åº¦ç›‘æ§', icon: 'fa-heart-pulse', path: '/health' },
  { id: 'risk', label: 'æ´¾å•', fullLabel: 'é£é™©ä¸æ´¾å•', icon: 'fa-triangle-exclamation', path: '/risk' },
  { id: 'tasks', label: 'å¸®æ‰¶', fullLabel: 'å¸®æ‰¶ä»»åŠ¡ä¸­å¿ƒ', icon: 'fa-hands-holding-circle', path: '/tasks' },

  // â­ æ–°å¢
  { id: 'archives', label: 'æ¡£æ¡ˆ', fullLabel: 'å¸®æ‰¶æ¡£æ¡ˆåº“', icon: 'fa-folder-open', path: '/archives' },

  { id: 'inspection', label: 'å·¡åº—', fullLabel: 'ç°åœºå·¡åº—', icon: 'fa-clipboard-check', path: '/inspection' },
  { id: 'knowledge', label: 'çŸ¥è¯†åº“', fullLabel: 'çŸ¥è¯†åº“æ²‰æ·€', icon: 'fa-book-open', path: '/knowledge' },
];
```

**æ”¹åŠ¨2: é«˜äº®é€»è¾‘** (Desktop + Mobile)
```tsx
// âŒ æ—§é€»è¾‘
const isActive = pathname === item.path;

// âœ… æ–°é€»è¾‘ (æ”¯æŒ /archives/[merchantId])
const isActive = pathname === item.path ||
  (item.path === '/archives' && pathname.startsWith('/archives/'));
```

---

#### 3. `components/merchants/MerchantHistoryArchive.tsx` (+~15è¡Œ)

**æ–°å¢åŠŸèƒ½**: "æŸ¥çœ‹å®Œæ•´æ¡£æ¡ˆ"æŒ‰é’®

**æ”¹åŠ¨1: å¯¼å…¥Link**
```tsx
import Link from 'next/link';
```

**æ”¹åŠ¨2: æ·»åŠ æŒ‰é’®** (åœ¨Tabå¯¼èˆªä¸Šæ–¹)
```tsx
return (
  <div className="space-y-6">
    {/* â­ æ–°å¢ï¼šæŸ¥çœ‹å®Œæ•´æ¡£æ¡ˆæŒ‰é’® */}
    <div className="flex justify-end">
      <Link
        href={`/archives/${merchant.id}`}
        className="px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors flex items-center gap-2 text-sm font-medium shadow-sm"
      >
        <i className="fas fa-expand-alt"></i>
        æŸ¥çœ‹å®Œæ•´æ¡£æ¡ˆ
      </Link>
    </div>

    {/* åŸæœ‰çš„Tabå¯¼èˆª */}
    <div className="bg-white rounded-xl shadow-sm...">
```

**æ”¹åŠ¨3: ä¼ é€’merchantIdç»™AssistanceArchiveSummary**
```tsx
{activeTab === 'summary' && (
  <AssistanceArchiveSummary
    archive={archive}
    merchantId={merchant.id}  // â­ æ–°å¢
    onExport={handleExport}
  />
)}
```

---

#### 4. `app/health/page.tsx` (+~8è¡Œ)

**æ–°å¢åŠŸèƒ½**: å•†æˆ·åç§°æ—æ·»åŠ æ¡£æ¡ˆé“¾æ¥

**æ”¹åŠ¨ä½ç½®**: å³ä¾§è¯¦æƒ…é¢æ¿å•†æˆ·ä¿¡æ¯åŒº (line 425-432)

```tsx
// âŒ æ—§ä»£ç 
<div>
  <h3 className="text-lg xl:text-xl font-bold text-slate-900">{selectedMerchant.name}</h3>
  <p className="text-slate-500 text-xs xl:text-sm">{selectedMerchant.category} â€¢ {selectedMerchant.floor}</p>
</div>

// âœ… æ–°ä»£ç 
<div>
  <div className="flex items-center gap-2">
    <h3 className="text-lg xl:text-xl font-bold text-slate-900">{selectedMerchant.name}</h3>
    {/* â­ æ–°å¢æ¡£æ¡ˆé“¾æ¥ */}
    <Link
      href={`/archives/${selectedMerchant.id}`}
      className="text-sm text-indigo-600 hover:text-indigo-800 hover:underline flex items-center gap-1 transition-colors"
    >
      <i className="fas fa-folder-open text-xs"></i>
      æ¡£æ¡ˆ
    </Link>
  </div>
  <p className="text-slate-500 text-xs xl:text-sm">{selectedMerchant.category} â€¢ {selectedMerchant.floor}</p>
</div>
```

---

## ç”¨æˆ·ä½“éªŒæå‡

### 1. ç»Ÿè®¡æ•°å­—äº¤äº’æ”¹å–„

**é—®é¢˜**: æ¡£æ¡ˆæ‘˜è¦ä¸­çš„ç»Ÿè®¡æ•°å­—åªæ˜¯çº¯å±•ç¤ºï¼Œç”¨æˆ·æ— æ³•æŸ¥çœ‹æ˜ç»†

**è§£å†³æ–¹æ¡ˆ**:

âœ… **å¯ç‚¹å‡»å¡ç‰‡**:
- 5ä¸ªç»Ÿè®¡å¡ç‰‡å…¨éƒ¨æ”¹ä¸ºå¯ç‚¹å‡»æŒ‰é’®
- Hoveræ—¶èƒŒæ™¯å˜è‰² + é˜´å½±æ•ˆæœ
- æ˜¾ç¤ºå³ç®­å¤´å›¾æ ‡æç¤ºå¯ç‚¹å‡»
- åº•éƒ¨æ˜¾ç¤º"ç‚¹å‡»æŸ¥çœ‹æ˜ç»†"æ–‡å­—

âœ… **æ˜ç»†å¼¹çª—**:
- ç‚¹å‡»åå¼¹å‡º4xlå®½åº¦çš„æ¨¡æ€æ¡†
- æœ€å¤§é«˜åº¦70vhï¼Œå†…å®¹å¯æ»šåŠ¨
- æ˜¾ç¤ºå®Œæ•´çš„åˆ—è¡¨æ•°æ®ï¼ˆå¿«ç…§/é£é™©å˜æ›´/ä»»åŠ¡ç­‰ï¼‰
- ESCé”®æˆ–ç‚¹å‡»èƒŒæ™¯å…³é—­

**æ•ˆæœå¯¹æ¯”**:

| å¡ç‰‡ | ç‚¹å‡»å‰ | ç‚¹å‡»å |
|------|--------|--------|
| å†å²è®°å½• | æ˜¾ç¤º"12" | å¼¹çª—å±•ç¤º12ä¸ªå¿«ç…§çš„è¯¦ç»†åˆ—è¡¨ |
| é£é™©å˜æ›´ | æ˜¾ç¤º"5æ¬¡" | å¼¹çª—å±•ç¤º5æ¬¡é£é™©å˜æ›´çš„beforeâ†’afterå¯¹æ¯” |
| å¸®æ‰¶ä»»åŠ¡ | æ˜¾ç¤º"2/2" | å¼¹çª—å±•ç¤º2ä¸ªä»»åŠ¡çš„æªæ–½å’Œæ•ˆæœ |
| é£é™©é™ä½ | æ˜¾ç¤º"3æ¬¡" | å¼¹çª—å±•ç¤º3æ¬¡æ”¹å–„äº‹ä»¶çš„è¯¦æƒ… |
| é£é™©å‡é«˜ | æ˜¾ç¤º"2æ¬¡" | å¼¹çª—å±•ç¤º2æ¬¡æ¶åŒ–äº‹ä»¶çš„åŸå›  |

---

### 2. ç©ºé—´ä¸è¶³é—®é¢˜æ”¹å–„

**é—®é¢˜**: æ¡£æ¡ˆåœ¨å¥åº·åº¦è¯¦æƒ…é¢æ¿åº•éƒ¨ï¼Œç©ºé—´æœ‰é™ï¼Œå›¾è¡¨å’Œæ–‡å­—è¢«å‹ç¼©

**è§£å†³æ–¹æ¡ˆ**:

âœ… **ç‹¬ç«‹å…¨å±é¡µé¢** (`/archives/[merchantId]`):
- ä¸“é—¨çš„æ¡£æ¡ˆè¯¦æƒ…é¡µï¼Œä¸å—å…¶ä»–å†…å®¹é™åˆ¶
- å¤ç”¨ `MerchantHistoryArchive` ç»„ä»¶ï¼Œä½†æ˜¾ç¤ºç©ºé—´å……è¶³
- å›¾è¡¨å’Œè¶‹åŠ¿å›¾å®Œå…¨èˆ’å±•ï¼Œæ¸…æ™°å¯è§

âœ… **å¤šå¤„å¿«æ·å…¥å£** (4ä¸ª):
1. **ä¾§è¾¹æ å¯¼èˆª**: "å¸®æ‰¶ä»»åŠ¡ä¸­å¿ƒ" å’Œ "ç°åœºå·¡åº—" ä¹‹é—´
2. **å¥åº·åº¦è¯¦æƒ…**: å•†æˆ·åç§°æ—è¾¹çš„"æ¡£æ¡ˆ"é“¾æ¥
3. **æ¡£æ¡ˆæ‘˜è¦ä¸Šæ–¹**: "æŸ¥çœ‹å®Œæ•´æ¡£æ¡ˆ"æŒ‰é’®ï¼ˆè“è‰²é†’ç›®ï¼‰
4. **æ¡£æ¡ˆåº“ä¸»é¡µ**: `/archives` åˆ—è¡¨é¡µçš„"æŸ¥çœ‹"æŒ‰é’®

**å¯¼èˆªè·¯å¾„ç¤ºä¾‹**:
```
ç”¨æˆ·åœ¨å¥åº·åº¦ç›‘æ§é¡µé¢ (/health)
  â†“ é€‰æ‹©å•†æˆ·"æµ·åº•æç«é”…"
  â†“ çœ‹åˆ°æ¡£æ¡ˆæ‘˜è¦ï¼Œç©ºé—´å—é™
  â†“ ç‚¹å‡»"æŸ¥çœ‹å®Œæ•´æ¡£æ¡ˆ"æŒ‰é’®
  â†“ è·³è½¬åˆ° /archives/M001
  âœ… å…¨å±å±•ç¤ºæ¡£æ¡ˆï¼Œå›¾è¡¨æ¸…æ™°å¯è§
```

---

## æŠ€æœ¯äº®ç‚¹

### 1. æ€§èƒ½ä¼˜åŒ–
- **useMemoç¼“å­˜**: æ¡£æ¡ˆæ•°æ®ã€å¿«ç…§ã€é£é™©å˜æ›´ã€è¿‡æ»¤ç»“æœ
- **æŒ‰éœ€åŠ è½½**: åªåœ¨ç‚¹å‡»æ—¶æ‰è·å–æ˜ç»†æ•°æ®
- **ç»„ä»¶å¤ç”¨**: ç»Ÿè®¡æ˜ç»†å¼¹çª—ä¸­çš„åˆ—è¡¨ç»„ä»¶å¤ç”¨å·¥å…·å‡½æ•°

### 2. ç”¨æˆ·ä½“éªŒ
- **æ¸è¿›å¼äº¤äº’**: Hover â†’ ç‚¹å‡» â†’ å¼¹çª—
- **è§†è§‰åé¦ˆ**: èƒŒæ™¯è‰²å˜åŒ–ã€é˜´å½±ã€å›¾æ ‡ã€æç¤ºæ–‡å­—
- **é”®ç›˜æ”¯æŒ**: ESCé”®å…³é—­å¼¹çª—
- **ç‚¹å‡»å¤–éƒ¨å…³é—­**: æ¨¡æ€æ¡†èƒŒæ™¯ç‚¹å‡»å…³é—­

### 3. æ•°æ®ä¸€è‡´æ€§
- **å•ä¸€æ•°æ®æº**: historyArchiveServiceç»Ÿä¸€æä¾›æ•°æ®
- **å®æ—¶åŒæ­¥**: å¿«ç…§/é£é™©å˜æ›´/ä»»åŠ¡æ•°æ®ä¿æŒä¸€è‡´
- **ç±»å‹å®‰å…¨**: å®Œæ•´çš„TypeScriptç±»å‹å®šä¹‰

### 4. å“åº”å¼è®¾è®¡
- **ç§»åŠ¨ç«¯é€‚é…**: æ¡£æ¡ˆåº“ä¸»é¡µæ”¯æŒå¡ç‰‡è§†å›¾
- **å¼¹çª—é€‚é…**: æ¨¡æ€æ¡†åœ¨å°å±å¹•ä¸‹è‡ªåŠ¨è°ƒæ•´å®½åº¦
- **å¯¼èˆªæ **: Desktopä¾§è¾¹æ  + Mobileåº•éƒ¨å¯¼èˆª

---

## éªŒè¯æµ‹è¯•

### æ„å»ºéªŒè¯
```bash
âœ“ Compiled successfully in 2.7s
âœ“ Running TypeScript
âœ“ Generating static pages (14/14)
âœ“ Finalizing page optimization
```

**è·¯ç”±ç”Ÿæˆ**:
```
â—‹  /archives                    # æ¡£æ¡ˆåº“ä¸»é¡µ (é™æ€)
Æ’  /archives/[merchantId]       # æ¡£æ¡ˆè¯¦æƒ… (åŠ¨æ€)
```

### åŠŸèƒ½éªŒè¯æ¸…å•

**1. ç»Ÿè®¡æ•°å­—ç‚¹å‡»äº¤äº’**:
- âœ… è®¿é—® `/health` é€‰æ‹©ä»»æ„å•†æˆ·
- âœ… æ»šåŠ¨åˆ°"å†å²å¸®æ‰¶æ¡£æ¡ˆ"
- âœ… Hoverç»Ÿè®¡å¡ç‰‡ï¼ŒéªŒè¯èƒŒæ™¯å˜è‰²å’Œé˜´å½±
- âœ… ç‚¹å‡»"å†å²è®°å½•"ï¼ŒéªŒè¯å¼¹å‡ºå¿«ç…§åˆ—è¡¨
- âœ… éªŒè¯å¿«ç…§æ•°æ®æ­£ç¡®ï¼ˆæ—¶é—´ã€è¯„åˆ†ã€è§¦å‘äº‹ä»¶ï¼‰
- âœ… ä¾æ¬¡æµ‹è¯•å…¶ä»–4ä¸ªå¡ç‰‡ï¼ˆé£é™©å˜æ›´/ä»»åŠ¡/é™ä½/å‡é«˜ï¼‰
- âœ… ESCé”®å…³é—­å¼¹çª—
- âœ… ç‚¹å‡»èƒŒæ™¯å…³é—­å¼¹çª—

**2. ç‹¬ç«‹æ¡£æ¡ˆé¡µé¢**:
- âœ… è®¿é—® `/archives`ï¼ŒéªŒè¯æ˜¾ç¤ºå•†æˆ·åˆ—è¡¨
- âœ… æœç´¢"æµ·åº•æ"ï¼ŒéªŒè¯ç­›é€‰åŠŸèƒ½
- âœ… é€‰æ‹©"é«˜é£é™©"ç­›é€‰ï¼ŒéªŒè¯è¿‡æ»¤
- âœ… åˆ‡æ¢æ’åºï¼ˆå¥åº·åº¦/æˆåŠŸç‡ï¼‰ï¼ŒéªŒè¯æ’åº
- âœ… åˆ‡æ¢å¡ç‰‡è§†å›¾ï¼ŒéªŒè¯å¸ƒå±€å˜åŒ–
- âœ… ç‚¹å‡»"æŸ¥çœ‹"ï¼Œè·³è½¬åˆ° `/archives/M001`
- âœ… éªŒè¯å•†æˆ·åŸºæœ¬ä¿¡æ¯æ˜¾ç¤ºæ­£ç¡®
- âœ… éªŒè¯4ä¸ªTabæ­£å¸¸åˆ‡æ¢
- âœ… éªŒè¯å›¾è¡¨ç©ºé—´å……è¶³ï¼Œä¸å‹ç¼©

**3. å¿«æ·å…¥å£**:
- âœ… ä¾§è¾¹æ "æ¡£æ¡ˆåº“"èœå•é¡¹æ˜¾ç¤ºæ­£ç¡®
- âœ… ç‚¹å‡»è¿›å…¥ `/archives`
- âœ… éªŒè¯é«˜äº®çŠ¶æ€ï¼ˆæ¡£æ¡ˆåº“èœå•é¡¹èƒŒæ™¯å˜è“ï¼‰
- âœ… è¿›å…¥ `/archives/M001`ï¼ŒéªŒè¯ä¾§è¾¹æ ä»é«˜äº®
- âœ… å¥åº·åº¦é¡µé¢å•†æˆ·åç§°æ—æ˜¾ç¤º"æ¡£æ¡ˆ"é“¾æ¥
- âœ… ç‚¹å‡»è·³è½¬åˆ°æ¡£æ¡ˆè¯¦æƒ…
- âœ… æ¡£æ¡ˆæ‘˜è¦ä¸Šæ–¹æ˜¾ç¤º"æŸ¥çœ‹å®Œæ•´æ¡£æ¡ˆ"æŒ‰é’®
- âœ… ç‚¹å‡»è·³è½¬åˆ°ç‹¬ç«‹é¡µé¢

**4. æ•°æ®ä¸€è‡´æ€§**:
- âœ… æ¡£æ¡ˆåº“åˆ—è¡¨çš„ç»Ÿè®¡æ•°æ®ä¸è¯¦æƒ…é¡µä¸€è‡´
- âœ… ç»Ÿè®¡å¡ç‰‡æ•°å­—ä¸æ˜ç»†åˆ—è¡¨æ•°é‡ä¸€è‡´
- âœ… å¿«ç…§æ•°é‡ = å¼¹çª—ä¸­å¿«ç…§åˆ—è¡¨é•¿åº¦
- âœ… é£é™©å˜æ›´æ¬¡æ•° = å¼¹çª—ä¸­å˜æ›´åˆ—è¡¨é•¿åº¦

---

## ä»£ç ç»Ÿè®¡

**æ–°å¢**:
- æ–‡ä»¶: 6ä¸ª
- æ€»è¡Œæ•°: ~1,250è¡Œ

**ä¿®æ”¹**:
- æ–‡ä»¶: 4ä¸ª
- æ–°å¢è¡Œæ•°: ~113è¡Œ

**æ€»è®¡**: æ–°å¢/ä¿®æ”¹ ~1,363è¡Œä»£ç 

---

## ä¸‹ä¸€æ­¥å»ºè®®

### å¯é€‰ä¼˜åŒ– (Phase 4)

1. **åˆ†é¡µåŠ è½½** (ä¼˜å…ˆçº§: P2)
   - æ¡£æ¡ˆåº“ä¸»é¡µå•†æˆ·åˆ—è¡¨è¾ƒå¤šæ—¶ä½¿ç”¨åˆ†é¡µ
   - æ˜ç»†å¼¹çª—ä¸­çš„åˆ—è¡¨æ•°æ®åˆ†é¡µåŠ è½½

2. **å¯¼å‡ºåŠŸèƒ½å¢å¼º** (ä¼˜å…ˆçº§: P2)
   - æ”¯æŒå¯¼å‡ºPDFæ ¼å¼æ¡£æ¡ˆ
   - æ‰¹é‡å¯¼å‡ºå¤šä¸ªå•†æˆ·æ¡£æ¡ˆ

3. **ç­›é€‰æ¡ä»¶æ‰©å±•** (ä¼˜å…ˆçº§: P3)
   - æŒ‰æ—¶é—´èŒƒå›´ç­›é€‰ (è¿‘30å¤©æœ‰å˜æ›´)
   - æŒ‰æˆåŠŸç‡ç­›é€‰ (>80%)
   - æŒ‰ä¸šæ€ç­›é€‰

4. **æ•°æ®å¯è§†åŒ–å¢å¼º** (ä¼˜å…ˆçº§: P3)
   - æ¡£æ¡ˆåº“ä¸»é¡µæ·»åŠ æ±‡æ€»å›¾è¡¨
   - é£é™©å˜æ›´è¶‹åŠ¿å›¾
   - æˆåŠŸç‡å¯¹æ¯”å›¾

---

## æ€»ç»“

Phase 3 æˆåŠŸå®ç°äº†ç”¨æˆ·æå‡ºçš„ä¸¤ä¸ªæ ¸å¿ƒéœ€æ±‚ï¼š

âœ… **ç»Ÿè®¡æ•°å­—äº¤äº’**: 6ä¸ªç»Ÿè®¡å¡ç‰‡ç°åœ¨å¯ç‚¹å‡»æŸ¥çœ‹æ˜ç»†ï¼Œç”¨æˆ·å¯ä»¥æ·±å…¥äº†è§£æ¯ä¸ªæ•°å­—èƒŒåçš„å…·ä½“æ•°æ®

âœ… **ç‹¬ç«‹æ¡£æ¡ˆé¡µé¢**: åˆ›å»ºäº†å®Œæ•´çš„æ¡£æ¡ˆåº“ç³»ç»Ÿï¼ŒåŒ…æ‹¬åˆ—è¡¨é¡µã€è¯¦æƒ…é¡µã€å¸ƒå±€ç»„ä»¶ï¼Œå¹¶æä¾›4ä¸ªå¿«æ·å…¥å£ï¼Œè§£å†³äº†ç©ºé—´ä¸è¶³å’Œè®¿é—®ä¸ä¾¿çš„é—®é¢˜

**ç”¨æˆ·ä»·å€¼**:
- ğŸ“Š **æ›´é€æ˜**: ç»Ÿè®¡æ•°å­—ä¸å†æ˜¯é»‘ç›’ï¼Œç‚¹å‡»å³å¯æŸ¥çœ‹æ˜ç»†
- ğŸ–¥ï¸ **æ›´æ¸…æ™°**: å…¨å±æ¡£æ¡ˆé¡µé¢ï¼Œå›¾è¡¨å’Œæ–‡å­—å®Œå…¨èˆ’å±•
- ğŸš€ **æ›´ä¾¿æ·**: 4ä¸ªå…¥å£éšæ—¶è®¿é—®æ¡£æ¡ˆï¼Œä¸å†éœ€è¦æ»šåŠ¨åˆ°åº•éƒ¨
- ğŸ“ˆ **æ›´é«˜æ•ˆ**: ç‹¬ç«‹çš„æ¡£æ¡ˆåº“ä¸»é¡µæ”¯æŒæœç´¢ã€ç­›é€‰ã€æ’åºï¼Œå¿«é€Ÿå®šä½ç›®æ ‡å•†æˆ·

**æŠ€æœ¯è´¨é‡**:
- âœ… TypeScriptç±»å‹å®Œæ•´
- âœ… ç»„ä»¶é«˜åº¦å¤ç”¨
- âœ… æ€§èƒ½ä¼˜åŒ–ï¼ˆuseMemoï¼‰
- âœ… å“åº”å¼è®¾è®¡
- âœ… æ— ç¼–è¯‘é”™è¯¯

---

**Phase 1 + Phase 2 + Phase 3 å…¨éƒ¨å®Œæˆ** ğŸ‰

æ•´ä¸ªå•†æˆ·å†å²å¸®æ‰¶æ¡£æ¡ˆåŠŸèƒ½å·²å®Œæ•´å®ç°ï¼ŒåŒ…æ‹¬æ•°æ®æ¨¡å‹ã€å±•ç¤ºå¢å¼ºå’Œç”¨æˆ·äº¤äº’ä¼˜åŒ–ã€‚
